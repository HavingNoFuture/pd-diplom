
<main role="main">
  <div class="header">
    <a href="{% url 'cart' %}">Корзина</a>
  </div>
  <div class="menu" style="width: 15%; display: inline-block">
    <div class="categories">
      <p>Категории:</p>
      <ul>
        {% for category in categories %}
        <li><a href="{% url 'catalog' %}?category={{ category.name }}">{{ category.name }}</a></li>
        {% endfor %}
      </ul>
    </div>
    <div class="shops">
      <p>Магазины:</p>
      <ul>
        {% for shop in shops %}
        <li><a href="{% url 'catalog' %}?shop={{ shop.name }}">{{ shop.name }}</a></li>
        {% endfor %}
      </ul>
    </div>

  </div>

  <div class="catalog" style="display: inline-block">
    <h1>Продукты:</h1>
    {% for product in product_infos %}
        <div class="product_container" style="display: inline-block; width: 200px">
          <h2><a href="#">{{product.product.name}}</a></h2>
          <p>Магазин: {{product.shop.name}}</p>
          <p>Параметры:</p>
          {% for product_parameter in product.productparameter_set.all %}
          <p>{{product_parameter.parameter.name}} - {{product_parameter.value}}</p>
          {% endfor %}
          <p>Категория: {{product.product.category.name}}</p>
          <a class="add-to-cart" href="#" data-slug="{{product.product.slug}}" >Добавить в корзину</a>
        </div>
    {% endfor %}
  </div>

</main>

<script>
  window.addEventListener('load', e => {
    buttons = document.querySelectorAll('.add-to-cart');

    for (let btn of buttons) {
      btn.addEventListener('click', e => {
        e.preventDefault();
        slug = e.target.dataset.slug;
        console.log(slug)

        fetch(`{% url 'add_to_cart' %}?slug=${slug}`, {
          method: 'GET',
        }).then((res) => {
          return res.json();
        }).then((data) => {

        })
      });
    }
  });
</script>
